<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HUB Email Logger</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
<style>
:root {
  --gold: #b09e6f;
  --gold-light: #c9b896;
  --gold-dark: #9a8a5e;
  --charcoal: #2a2a2a;
  --charcoal-light: #3d3d3d;
  --cream: #f8f6f3;
  --cream-dark: #efe9e1;
  --white: #ffffff;
  --text-primary: #2a2a2a;
  --text-secondary: #666666;
  --text-muted: #888888;
  --border: #e5e0d8;
  --success: #4a9d6b;
  --success-bg: #e8f5ed;
  --error: #c54040;
  --error-bg: #fbeaea;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-size: 13px;
  line-height: 1.5;
  color: var(--text-primary);
  background: var(--cream);
}

#app { min-height: 100vh; display: flex; flex-direction: column; }

/* Header */
.header {
  background: linear-gradient(135deg, var(--charcoal) 0%, var(--charcoal-light) 100%);
  color: var(--white);
  padding: 16px 20px;
  display: flex;
  align-items: center;
  gap: 12px;
  border-bottom: 3px solid var(--gold);
}

.header-logo {
  width: 28px;
  height: 28px;
  background: var(--gold);
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 14px;
  color: var(--charcoal);
}

.header h1 {
  font-size: 16px;
  font-weight: 600;
  letter-spacing: -0.3px;
}

/* Main content */
.main { flex: 1; padding: 16px; display: flex; flex-direction: column; gap: 14px; }

/* Loading */
.loading { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; gap: 14px; }
.spinner {
  width: 36px;
  height: 36px;
  border: 3px solid var(--border);
  border-top-color: var(--gold);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }
.loading p { color: var(--text-secondary); font-size: 13px; }

.hidden { display: none !important; }

/* Cards */
.email-card {
  background: var(--white);
  border-radius: 10px;
  padding: 16px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  border: 1px solid var(--border);
}

.email-header {
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 12px;
  color: var(--text-primary);
  word-break: break-word;
  line-height: 1.4;
}

.email-meta { font-size: 12px; color: var(--text-secondary); display: flex; flex-direction: column; gap: 4px; }
.label { color: var(--text-muted); font-weight: 500; }

.attachments-section { margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border); }
.attachments-list { list-style: none; margin-top: 8px; display: flex; flex-direction: column; gap: 4px; }
.attachments-list li {
  font-size: 11px;
  color: var(--text-secondary);
  padding: 6px 10px;
  background: var(--cream);
  border-radius: 6px;
  border: 1px solid var(--border);
}

/* Search */
.search-section { display: flex; flex-direction: column; gap: 12px; }
.search-input-wrapper { display: flex; gap: 8px; }

#search-input {
  flex: 1;
  padding: 11px 14px;
  border: 1px solid var(--border);
  border-radius: 8px;
  font-size: 13px;
  background: var(--white);
  transition: all 0.2s;
}
#search-input:focus {
  outline: none;
  border-color: var(--gold);
  box-shadow: 0 0 0 3px rgba(176, 158, 111, 0.15);
}
#search-input::placeholder { color: var(--text-muted); }

.btn-search {
  padding: 11px 18px;
  background: var(--gold);
  color: var(--white);
  border: none;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-search:hover { background: var(--gold-dark); }

/* Search results */
.search-results { display: flex; flex-direction: column; gap: 8px; max-height: 220px; overflow-y: auto; }

.suggestion-header {
  font-size: 11px;
  font-weight: 600;
  color: var(--gold-dark);
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  gap: 6px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.result-item {
  padding: 12px 14px;
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
}
.result-item:hover {
  border-color: var(--gold-light);
  background: var(--cream);
}
.result-item.selected {
  border-color: var(--gold);
  background: linear-gradient(135deg, rgba(176,158,111,0.08) 0%, rgba(176,158,111,0.04) 100%);
  box-shadow: 0 0 0 2px rgba(176,158,111,0.1);
}
.result-item.suggested {
  border-color: var(--gold);
  background: linear-gradient(135deg, rgba(176,158,111,0.1) 0%, rgba(176,158,111,0.05) 100%);
  border-width: 2px;
}

.result-item .name { font-weight: 600; color: var(--text-primary); font-size: 13px; }
.result-item .meta { font-size: 11px; color: var(--text-secondary); margin-top: 4px; }
.suggestion-reason { font-size: 10px; color: var(--gold-dark); margin-top: 6px; font-style: italic; }

.result-item .badge {
  display: inline-block;
  padding: 3px 8px;
  font-size: 10px;
  font-weight: 600;
  border-radius: 4px;
  margin-left: 8px;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}
.badge.lead { background: #e3f0fc; color: #1a6bb8; }
.badge.booking { background: #e3f5ed; color: #1a8b5a; }

.no-results { text-align: center; padding: 24px; color: var(--text-muted); font-size: 13px; }

/* Notes */
.notes-section { display: flex; flex-direction: column; gap: 6px; }
#notes-input {
  padding: 11px 14px;
  border: 1px solid var(--border);
  border-radius: 8px;
  font-size: 13px;
  font-family: inherit;
  resize: vertical;
  background: var(--white);
  transition: all 0.2s;
}
#notes-input:focus {
  outline: none;
  border-color: var(--gold);
  box-shadow: 0 0 0 3px rgba(176, 158, 111, 0.15);
}

/* Action section */
.action-section { margin-top: auto; display: flex; flex-direction: column; gap: 10px; }

.selected-entity {
  padding: 12px 14px;
  background: linear-gradient(135deg, rgba(176,158,111,0.12) 0%, rgba(176,158,111,0.06) 100%);
  border: 1px solid rgba(176,158,111,0.3);
  border-radius: 8px;
  font-size: 12px;
  text-align: center;
  color: var(--text-primary);
  font-weight: 500;
}

.action-buttons { display: flex; gap: 8px; flex-wrap: wrap; }

.btn-primary {
  flex: 1;
  padding: 13px 16px;
  background: linear-gradient(135deg, var(--charcoal) 0%, var(--charcoal-light) 100%);
  color: var(--white);
  border: none;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  min-width: 110px;
}
.btn-primary:hover:not(:disabled) {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(42,42,42,0.25);
}
.btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }

.btn-secondary {
  flex: 1;
  padding: 13px 16px;
  background: var(--white);
  color: var(--text-primary);
  border: 1.5px solid var(--border);
  border-radius: 8px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  min-width: 110px;
}
.btn-secondary:hover { background: var(--cream); border-color: var(--gold-light); }

.btn-task {
  flex: 1;
  padding: 13px 16px;
  background: var(--white);
  color: var(--gold-dark);
  border: 2px solid var(--gold);
  border-radius: 8px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  min-width: 110px;
}
.btn-task:hover { background: rgba(176,158,111,0.08); }
.btn-task:disabled { opacity: 0.5; cursor: not-allowed; }

/* Messages */
.message-container { padding: 12px 14px; border-radius: 8px; text-align: center; font-weight: 500; font-size: 13px; }
.message-container.success { background: var(--success-bg); color: var(--success); border: 1px solid rgba(74,157,107,0.3); }
.message-container.error { background: var(--error-bg); color: var(--error); border: 1px solid rgba(197,64,64,0.3); }

/* Login section */
.login-section { display: flex; flex-direction: column; gap: 14px; padding: 20px; }
.login-section h2 { font-size: 16px; color: var(--text-primary); text-align: center; font-weight: 600; }
.login-section p { font-size: 13px; color: var(--text-secondary); text-align: center; }

.form-group { display: flex; flex-direction: column; gap: 6px; }
.form-group label { font-size: 12px; font-weight: 600; color: var(--text-primary); }
.form-group input, .form-group select, .form-group textarea {
  padding: 12px 14px;
  border: 1px solid var(--border);
  border-radius: 8px;
  font-size: 13px;
  font-family: inherit;
  background: var(--white);
  transition: all 0.2s;
}
.form-group input:focus, .form-group select:focus, .form-group textarea:focus {
  outline: none;
  border-color: var(--gold);
  box-shadow: 0 0 0 3px rgba(176, 158, 111, 0.15);
}

/* User info */
.user-info {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 14px;
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: 8px;
  font-size: 12px;
}
.user-info span { color: var(--text-primary); font-weight: 500; }
.btn-logout {
  padding: 6px 12px;
  background: transparent;
  border: 1px solid var(--error);
  color: var(--error);
  border-radius: 6px;
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-logout:hover { background: var(--error); color: var(--white); }

/* Logged emails section */
.logged-emails-section { display: flex; flex-direction: column; gap: 12px; }
.section-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 6px; }
.section-title { font-size: 13px; font-weight: 600; color: var(--text-primary); }
.btn-back {
  padding: 6px 12px;
  background: transparent;
  border: 1px solid var(--border);
  color: var(--text-primary);
  border-radius: 6px;
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 4px;
  transition: all 0.2s;
}
.btn-back:hover { background: var(--cream); border-color: var(--gold-light); }

.logged-emails-list { display: flex; flex-direction: column; gap: 8px; max-height: 400px; overflow-y: auto; }
.logged-email-item {
  padding: 12px 14px;
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: 8px;
  transition: all 0.2s;
}
.logged-email-item:hover { border-color: var(--gold-light); background: var(--cream); }
.email-subject-line { font-weight: 600; color: var(--text-primary); font-size: 12px; margin-bottom: 4px; line-height: 1.4; }
.email-sender { font-size: 11px; color: var(--text-secondary); }
.email-date { font-size: 10px; color: var(--text-muted); margin-top: 2px; }
.email-actions { display: flex; gap: 8px; margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border); }
.action-btn {
  padding: 6px 12px;
  background: var(--cream);
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}
.action-btn:hover { background: var(--cream-dark); }
.reply-btn:hover { background: #e3f0fc; border-color: #1a6bb8; color: #1a6bb8; }
.forward-btn:hover { background: rgba(176,158,111,0.12); border-color: var(--gold); color: var(--gold-dark); }

/* Task modal */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(42,42,42,0.6);
  backdrop-filter: blur(2px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  padding: 16px;
}
.modal-content {
  background: var(--white);
  border-radius: 12px;
  padding: 20px;
  width: 100%;
  max-width: 360px;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 20px 60px rgba(0,0,0,0.2);
  border: 1px solid var(--border);
}
.modal-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 18px; }
.modal-title { font-size: 15px; font-weight: 600; color: var(--text-primary); }
.btn-close {
  width: 30px;
  height: 30px;
  border: none;
  background: var(--cream);
  border-radius: 6px;
  cursor: pointer;
  font-size: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-secondary);
  transition: all 0.2s;
}
.btn-close:hover { background: var(--cream-dark); color: var(--text-primary); }
.modal-body { display: flex; flex-direction: column; gap: 14px; }
.modal-footer { display: flex; gap: 8px; margin-top: 18px; }

/* Scrollbar styling */
.search-results::-webkit-scrollbar,
.logged-emails-list::-webkit-scrollbar { width: 5px; }
.search-results::-webkit-scrollbar-track,
.logged-emails-list::-webkit-scrollbar-track { background: var(--cream); border-radius: 3px; }
.search-results::-webkit-scrollbar-thumb,
.logged-emails-list::-webkit-scrollbar-thumb { background: var(--gold-light); border-radius: 3px; }
.search-results::-webkit-scrollbar-thumb:hover,
.logged-emails-list::-webkit-scrollbar-thumb:hover { background: var(--gold); }
</style>
</head>
<body>
<div id="app">
<header class="header">
  <div class="header-logo">H</div>
  <h1>Log til HUB</h1>
</header>
<main class="main">
<!-- Login Section -->
<section id="login-section" class="login-section">
<h2>Log ind for at forts√¶tte</h2>
<p>Brug dine HUB login-oplysninger</p>
<div class="form-group">
<label for="login-email">Email</label>
<input type="email" id="login-email" placeholder="din@email.dk" autocomplete="email"/>
</div>
<div class="form-group">
<label for="login-password">Adgangskode</label>
<input type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password"/>
</div>
<button id="btn-login" class="btn-primary">Log ind</button>
<div id="login-error" class="message-container error hidden"></div>
</section>

<!-- MFA Section -->
<section id="mfa-section" class="login-section hidden">
<h2>üîê To-faktor godkendelse</h2>
<p>Indtast koden fra din authenticator app</p>
<div class="form-group">
<label for="mfa-code">Bekr√¶ftelseskode</label>
<input type="text" id="mfa-code" placeholder="000000" maxlength="6" autocomplete="one-time-code" inputmode="numeric" pattern="[0-9]*"/>
</div>
<button id="btn-verify-mfa" class="btn-primary">Bekr√¶ft</button>
<button id="btn-cancel-mfa" class="btn-secondary" style="margin-top:8px">Annuller</button>
<div id="mfa-error" class="message-container error hidden"></div>
</section>

<!-- Main App -->
<div id="app-content" class="hidden">
<div id="user-info" class="user-info">
<span id="user-email">-</span>
<button id="btn-logout" class="btn-logout">Log ud</button>
</div>

<div id="loading" class="loading"><div class="spinner"></div><p>Indl√¶ser email...</p></div>
<section id="email-preview" class="email-preview hidden">
<div class="email-card">
<div class="email-header"><strong id="email-subject">-</strong></div>
<div class="email-meta">
<div><span class="label">Fra:</span> <span id="email-from">-</span></div>
<div><span class="label">Til:</span> <span id="email-to">-</span></div>
<div><span class="label">Dato:</span> <span id="email-date">-</span></div>
</div>
<div id="attachments-section" class="attachments-section hidden">
<span class="label">Vedh√¶ftninger:</span>
<ul id="attachments-list" class="attachments-list"></ul>
</div>
</div>
</section>
<section id="search-section" class="search-section hidden">
<div class="search-input-wrapper">
<input type="text" id="search-input" placeholder="S√∏g efter navn, email, nummer..." autocomplete="off"/>
<button id="btn-search" class="btn-search">S√∏g</button>
</div>
<div id="search-results" class="search-results"></div>
</section>
<section id="notes-section" class="notes-section hidden">
<label for="notes-input" class="label">Noter (valgfrit):</label>
<textarea id="notes-input" placeholder="Tilf√∏j eventuelle noter til denne email..." rows="3"></textarea>
</section>
<section id="action-section" class="action-section hidden">
<div id="selected-entity" class="selected-entity"></div>
<div class="action-buttons">
<button id="btn-log-email" class="btn-primary" disabled>üìß Log Email</button>
<button id="btn-add-task" class="btn-task" disabled>üìã Opret Task</button>
</div>
<div class="action-buttons" style="margin-top:8px">
<button id="btn-view-emails" class="btn-secondary hidden">üìß Se emails</button>
</div>
</section>

<!-- Logged Emails Section -->
<section id="logged-emails-section" class="logged-emails-section hidden">
<div class="section-header">
<span class="section-title">Loggede emails p√• sagen</span>
<button id="btn-back-to-search" class="btn-back">‚Üê Tilbage</button>
</div>
<div id="logged-emails-list" class="logged-emails-list"></div>
</section>

<div id="message-container" class="message-container hidden"></div>
</div>
</main>
</div>

<!-- Task Modal -->
<div id="task-modal" class="modal-overlay hidden">
<div class="modal-content">
<div class="modal-header">
<span class="modal-title">üìã Opret Task</span>
<button id="btn-close-modal" class="btn-close">√ó</button>
</div>
<div class="modal-body">
<div class="form-group">
<label for="task-type">Type</label>
<select id="task-type">
<option value="task">Task</option>
<option value="call">Ring op</option>
<option value="email">Send email</option>
<option value="sms">Send SMS</option>
<option value="follow_up">Opf√∏lgning</option>
</select>
</div>
<div class="form-group">
<label for="task-date">Dato</label>
<input type="date" id="task-date"/>
</div>
<div class="form-group">
<label for="task-time">Tidspunkt (valgfrit)</label>
<input type="time" id="task-time" value="09:00"/>
</div>
<div class="form-group">
<label for="task-note">Beskrivelse</label>
<textarea id="task-note" rows="3" placeholder="Beskriv hvad der skal g√∏res..."></textarea>
</div>
</div>
<div class="modal-footer">
<button id="btn-cancel-task" class="btn-secondary">Annuller</button>
<button id="btn-save-task" class="btn-primary">Gem Task</button>
</div>
</div>
</div>

<script src="taskpane.js"></script>
</body>
</html>
